<!--
CODING SESSION: EVENT BUBBLING

1. Recap
    Write a function that prints the hierarchy of the button and all its parent elements.

    Example output:
    Element hierarchy: HTML > BODY > DIV > BUTTON

2. Visualize Event Bubbling
    Write a function that adds an event handler for the 'click' event to the button and all
    of its parent elements. The event handler should print the element tag name and an information
    whether the element has triggered the event or is part of the bubble chain.

    Example output:
    ðŸŽ¯ An element was clicked: BUTTON
    ðŸ«§ An element was clicked: DIV
    ðŸ«§ An element was clicked: BODY
    ðŸ«§ An element was clicked: HTML
-->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Coding Session: Event Bubbling ðŸ«§</title>
		<link rel="icon" type="text/plain" href="data:text/plain" />
		<style>
			div {
				border: 4px solid lightgrey;
				background-color: #eee;
				padding: 2rem;
			}
		</style>
	</head>
	<body>
		<h1>Coding Session: Event Bubbling ðŸ«§</h1>
		<div>
			<button>click me</button>
		</div>

		<script>
			const button = document.querySelector('button')

			const elementAndAllParents = getElementAndAllParentElements(button)

			printElementHierarchy(elementAndAllParents)
			addClickHandlersToAllElements(elementAndAllParents)

			function getElementAndAllParentElements(element) {
				let parents = [element]
				while (element.parentElement) {
					parents.push(element.parentElement)
					element = element.parentElement
				}
				return parents
			}

			function printElementHierarchy(elements) {
				const elementHierarchy = elements
					.reverse()
					.reduce(reduceElementNamesToString, '')
				console.log('Element hierarchy:', elementHierarchy)
			}

			function reduceElementNamesToString(prev, current, index) {
				const separator = index === 0 ? '' : ' > '
				return `${prev}${separator}${current.tagName}`
			}

			function addClickHandlersToAllElements(elements) {
				elements.forEach((e) => e.addEventListener('click', handleClick))
			}

			function handleClick(event) {
				const didElementTriggeredTheEvent = event.currentTarget === event.target
				const emoji = didElementTriggeredTheEvent ? 'ðŸŽ¯' : 'ðŸ«§'
				console.log(
					`${emoji} An element was clicked: ${event.currentTarget.tagName}`
				)
			}
		</script>
	</body>
</html>
